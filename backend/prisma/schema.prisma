generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model disbursed_items {
  id                Int      @id(map: "idx_16391_primary") @default(autoincrement())
  userid            Int
  code              String 
  withdrawal_amount Decimal  @db.Decimal(20, 2)
  psu_code          String
  date              DateTime
  facid             Int
  note              String

  @@index([facid])
}

model facs {
  id     Int    @id(map: "idx_16397_primary")
  fac    String
  userid Int?  

  items items[]
  user  users?   @relation( fields: [userid], references: [id], onDelete: SetNull )

  @@index([fac])
}

model items {
  code         String  @id(map: "idx_16402_primary") @db.VarChar(255)
  name         String
  total_amount Decimal @db.Decimal(20, 2)
  productid    Int
  facid        Int
  typeid       Int
  balance      Decimal @db.Decimal(20, 2)
  status       String  @db.VarChar(1)

  fac facs @relation(fields: [facid], references: [id])
  product products @relation( fields: [productid], references: [id])
  type types @relation(fields: [typeid], references: [id])

  @@index([status, facid, productid, typeid], name: "idx_status_facid_productid_typeid")
}

model plans {
  id   Int    @id(map: "idx_16407_primary")
  plan String
  product products[]

  @@index([plan])  
}

model products {
  id      Int    @id(map: "idx_16412_primary")
  product String
  planid  Int

  plan   plans   @relation(fields: [planid], references: [id])
  items items[]

  @@index([product])
}

model types {
  id   Int    @id(map: "idx_16417_primary")
  type String

  items items[]

  @@index([type])
}

enum Role {
  USER
  ADMIN
}

model users {
  id        Int     @id(map: "idx_16422_primary") @default(autoincrement())
  username  String  @unique
  password  String
  firstname String?
  lastname  String?
  role Role @default( USER )

  facs facs[]

  @@unique([id])
}